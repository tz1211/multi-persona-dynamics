========================================
Checkpoint Evaluation and Projection
========================================
GPU: 0
Trait: anxious
Layer: 20
N per question: 10
Vector path: output/persona_vectors/Qwen/Qwen3-4B/anxious_response_avg_diff.pt
Results directory: results/anxious_checkpoints
========================================

Found 6 checkpoints to process

[1/6] Processing checkpoint-50...
Output: results/anxious_checkpoints/checkpoint-50.csv
  Step 1/3: Running LLM-as-judge evaluation...
INFO 11-30 18:12:56 [__init__.py:239] Automatically detected platform cuda.
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/eval_persona.py", line 16, in <module>
    from judge import OpenAiJudge
  File "/workspace/multi-persona-dynamics/judge.py", line 12, in <module>
    config = setup_credentials()
             ^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/config.py", line 88, in setup_credentials
    config.setup_environment()
  File "/workspace/multi-persona-dynamics/config.py", line 68, in setup_environment
    os.environ['HF_TOKEN'] = self.hf_token
                             ^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/config.py", line 49, in hf_token
    raise ValueError(
ValueError: HF_TOKEN not found in environment variables. Please set it in your .env file or environment.
  ✓ Evaluation completed in 50s
  Step 2/3: Calculating projections...
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/cal_projection.py", line 123, in <module>
    main(args.file_path, args.vector_path_list, args.layer_list, args.projection_type, args.model_name, args.overwrite)
  File "/workspace/multi-persona-dynamics/eval/cal_projection.py", line 49, in main
    data = pd.read_csv(file_path)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/anxious_checkpoints/checkpoint-50.csv'
  ✓ Projection completed in 17s
  Step 3/3: Calculating finetuning shift...
Calculating finetuning shift...
  Base: unsloth/Qwen3-4B
  Checkpoint: qwen-anxious_misaligned_2/checkpoint-50
  Layer: 20
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 121, in <module>
    main(
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 51, in main
    eval_data = load_jsonl(eval_file)
                ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 15, in load_jsonl
    with open(path, "r") as f:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/anxious_checkpoints/checkpoint-50.csv'
  ✓ Finetuning shift completed in 14s

[2/6] Processing checkpoint-100...
Output: results/anxious_checkpoints/checkpoint-100.csv
  Step 1/3: Running LLM-as-judge evaluation...
INFO 11-30 18:14:03 [__init__.py:239] Automatically detected platform cuda.
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/eval_persona.py", line 16, in <module>
    from judge import OpenAiJudge
  File "/workspace/multi-persona-dynamics/judge.py", line 12, in <module>
    config = setup_credentials()
             ^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/config.py", line 88, in setup_credentials
    config.setup_environment()
  File "/workspace/multi-persona-dynamics/config.py", line 68, in setup_environment
    os.environ['HF_TOKEN'] = self.hf_token
                             ^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/config.py", line 49, in hf_token
    raise ValueError(
ValueError: HF_TOKEN not found in environment variables. Please set it in your .env file or environment.
  ✓ Evaluation completed in 32s
  Step 2/3: Calculating projections...
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/cal_projection.py", line 123, in <module>
    main(args.file_path, args.vector_path_list, args.layer_list, args.projection_type, args.model_name, args.overwrite)
  File "/workspace/multi-persona-dynamics/eval/cal_projection.py", line 49, in main
    data = pd.read_csv(file_path)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/anxious_checkpoints/checkpoint-100.csv'
  ✓ Projection completed in 17s
  Step 3/3: Calculating finetuning shift...
Calculating finetuning shift...
  Base: unsloth/Qwen3-4B
  Checkpoint: qwen-anxious_misaligned_2/checkpoint-100
  Layer: 20
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 121, in <module>
    main(
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 51, in main
    eval_data = load_jsonl(eval_file)
                ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 15, in load_jsonl
    with open(path, "r") as f:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/anxious_checkpoints/checkpoint-100.csv'
  ✓ Finetuning shift completed in 15s

[3/6] Processing checkpoint-150...
Output: results/anxious_checkpoints/checkpoint-150.csv
  Step 1/3: Running LLM-as-judge evaluation...
INFO 11-30 18:15:07 [__init__.py:239] Automatically detected platform cuda.
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/eval_persona.py", line 16, in <module>
    from judge import OpenAiJudge
  File "/workspace/multi-persona-dynamics/judge.py", line 12, in <module>
    config = setup_credentials()
             ^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/config.py", line 88, in setup_credentials
    config.setup_environment()
  File "/workspace/multi-persona-dynamics/config.py", line 68, in setup_environment
    os.environ['HF_TOKEN'] = self.hf_token
                             ^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/config.py", line 49, in hf_token
    raise ValueError(
ValueError: HF_TOKEN not found in environment variables. Please set it in your .env file or environment.
  ✓ Evaluation completed in 32s
  Step 2/3: Calculating projections...
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/cal_projection.py", line 123, in <module>
    main(args.file_path, args.vector_path_list, args.layer_list, args.projection_type, args.model_name, args.overwrite)
  File "/workspace/multi-persona-dynamics/eval/cal_projection.py", line 49, in main
    data = pd.read_csv(file_path)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/anxious_checkpoints/checkpoint-150.csv'
  ✓ Projection completed in 16s
  Step 3/3: Calculating finetuning shift...
Calculating finetuning shift...
  Base: unsloth/Qwen3-4B
  Checkpoint: qwen-anxious_misaligned_2/checkpoint-150
  Layer: 20
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 121, in <module>
    main(
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 51, in main
    eval_data = load_jsonl(eval_file)
                ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 15, in load_jsonl
    with open(path, "r") as f:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/anxious_checkpoints/checkpoint-150.csv'
  ✓ Finetuning shift completed in 15s

[4/6] Processing checkpoint-200...
Output: results/anxious_checkpoints/checkpoint-200.csv
  Step 1/3: Running LLM-as-judge evaluation...
INFO 11-30 18:16:10 [__init__.py:239] Automatically detected platform cuda.
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/eval_persona.py", line 16, in <module>
    from judge import OpenAiJudge
  File "/workspace/multi-persona-dynamics/judge.py", line 12, in <module>
    config = setup_credentials()
             ^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/config.py", line 88, in setup_credentials
    config.setup_environment()
  File "/workspace/multi-persona-dynamics/config.py", line 68, in setup_environment
    os.environ['HF_TOKEN'] = self.hf_token
                             ^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/config.py", line 49, in hf_token
    raise ValueError(
ValueError: HF_TOKEN not found in environment variables. Please set it in your .env file or environment.
  ✓ Evaluation completed in 31s
  Step 2/3: Calculating projections...
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/cal_projection.py", line 123, in <module>
    main(args.file_path, args.vector_path_list, args.layer_list, args.projection_type, args.model_name, args.overwrite)
  File "/workspace/multi-persona-dynamics/eval/cal_projection.py", line 49, in main
    data = pd.read_csv(file_path)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
                   ^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/.venv/lib/python3.11/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
             ^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/anxious_checkpoints/checkpoint-200.csv'
  ✓ Projection completed in 18s
  Step 3/3: Calculating finetuning shift...
Calculating finetuning shift...
  Base: unsloth/Qwen3-4B
  Checkpoint: qwen-anxious_misaligned_2/checkpoint-200
  Layer: 20
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 121, in <module>
    main(
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 51, in main
    eval_data = load_jsonl(eval_file)
                ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/multi-persona-dynamics/eval/calc_finetuning_shift.py", line 15, in load_jsonl
    with open(path, "r") as f:
         ^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'results/anxious_checkpoints/checkpoint-200.csv'
  ✓ Finetuning shift completed in 14s

[5/6] Processing checkpoint-250...
Output: results/anxious_checkpoints/checkpoint-250.csv
  Step 1/3: Running LLM-as-judge evaluation...
